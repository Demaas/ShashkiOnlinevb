<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–®–∞—à–∫–∏ –û–Ω–ª–∞–π–Ω</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="loginModal" class="modal">
      <div class="modal-content">
        <h2>–í—Ö–æ–¥ –≤ –∏–≥—Ä—É</h2>
        <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã</p>
        <input
          type="text"
          id="usernameInput"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫"
          maxlength="15"
        />
        <button id="startGameButton" class="start-button">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–∏–∫–Ω–µ–π–º–∞ -->
    <div id="nicknameModal" class="modal" style="display: none">
      <div class="modal-content">
        <h2>–ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º:</p>
        <input
          type="text"
          id="nicknameInput"
          placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º"
          maxlength="15"
        />
        <div class="modal-buttons">
          <button
            onclick="confirmNickname()"
            class="modal-btn confirm-btn"
            style="background-color: #2196f3"
          >
            –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
          </button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã -->
    <div id="gameOverModal" class="modal" style="display: none">
      <div class="modal-content">
        <h3>–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h3>
        <p id="gameOverMessage"></p>
        <div class="gif-container">
          <img
            src="https://media1.tenor.com/m/w_PLu8IF2Y8AAAAd/sml-joseph.gif"
            alt="Celebration"
            class="celebration-gif"
            style="max-width: 200px; border-radius: 10px; margin: 10px 0"
          />
        </div>
        <div class="modal-buttons">
          <button onclick="startNewGame()" class="modal-btn confirm-btn">
            –ù–æ–≤–∞—è –∏–≥—Ä–∞
          </button>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>
        <img src="shasemi.png" alt="–®–∞—à–∫–∏" class="title-icon" /> –®–∞—à–∫–∏ –û–Ω–ª–∞–π–Ω
      </h1>

      <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–æ–∫–∞—Ö —Å —Ñ–æ—Ç–æ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º —Ö–æ–¥–∞ -->
      <div class="players-info">
        <div class="player-info" id="whitePlayer">
          <img src="shabe.png" alt="–ë–µ–ª—ã–µ" class="player-icon" />
          <span class="player-nickname" id="whiteNickname"
            >–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</span
          >
          <span class="turn-indicator" id="whiteTurnIndicator">‚¨ÖÔ∏è –•–æ–¥</span>
        </div>

        <!-- ‚òÖ‚òÖ‚òÖ –î–û–ë–ê–í–õ–ï–ù –°–ß–Å–¢–ß–ò–ö –•–û–î–û–í ‚òÖ‚òÖ‚òÖ -->
        <div class="moves-counter">
          <div class="moves-counter-title">–°—á—ë—Ç—á–∏–∫ —Ö–æ–¥–æ–≤:</div>
          <div class="moves-counter-value" id="movesCounter">0 –• 0</div>
        </div>

        <div class="player-info" id="blackPlayer">
          <img src="shach.png" alt="–ß–µ—Ä–Ω—ã–µ" class="player-icon" />
          <span class="player-nickname" id="blackNickname"
            >–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</span
          >
          <span class="turn-indicator" id="blackTurnIndicator">‚û°Ô∏è –•–æ–¥</span>
        </div>
      </div>

      <!-- ‚òÖ‚òÖ‚òÖ –û–ö–ù–û –°–¢–ê–¢–£–°–ê –ò–ì–†–´ ‚òÖ‚òÖ‚òÖ -->
      <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

      <div class="game-layout">
        <!-- ‚òÖ‚òÖ‚òÖ –ö–û–õ–û–ù–ö–ò –í–´–ë–ò–¢–´–• –®–ê–®–ï–ö (–°–õ–ï–í–ê) ‚òÖ‚òÖ‚òÖ -->
        <div class="captured-pieces-container">
          <div class="captured-header">–í—ã–±–∏—Ç—ã–µ<br />—à–∞—à–∫–∏:</div>
          <div class="captured-columns">
            <div class="captured-pieces white-captured" id="whiteCaptured">
              <!-- –ë–µ–ª—ã–µ –≤—ã–±–∏—Ç—ã–µ —à–∞—à–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
            <div class="captured-pieces black-captured" id="blackCaptured">
              <!-- –ß–µ—Ä–Ω—ã–µ –≤—ã–±–∏—Ç—ã–µ —à–∞—à–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
          </div>
        </div>

        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å –¥–æ—Å–∫–æ–π -->
        <div class="board-column">
          <div class="board" id="board"></div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - —Å–º–∞–π–ª–∏–∫–∏ (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ) -->
        <div class="sidebar">
          <!-- ‚òÖ‚òÖ‚òÖ –í–ï–†–¢–ò–ö–ê–õ–¨–ù–´–ï –°–ú–ê–ô–õ–ò–ö–ò –í–ú–ï–°–¢–û –ö–ù–û–ü–ö–ò ‚òÖ‚òÖ‚òÖ -->
          <div class="vertical-smileys-container">
            <!-- –ü–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - 5 —Å–º–∞–π–ª–∏–∫–æ–≤ -->
            <div class="smileys-column">
              <button class="smiley-btn" data-smiley="üòÇ" data-sound="laugh">
                üòÇ
              </button>
              <button class="smiley-btn" data-smiley="üëä" data-sound="clown">
                üëä
              </button>
              <button class="smiley-btn" data-smiley="üëç" data-sound="cool">
                üëç
              </button>
              <button class="smiley-btn" data-smiley="üòÆ" data-sound="smirk">
                üòÆ
              </button>
              <button class="smiley-btn" data-smiley="ü§∑" data-sound="pig">
                ü§∑
              </button>
            </div>

            <!-- –í—Ç–æ—Ä–∞—è –∫–æ–ª–æ–Ω–∫–∞ - 5 —Å–º–∞–π–ª–∏–∫–æ–≤ -->
            <div class="smileys-column">
              <button class="smiley-btn" data-smiley="üò°" data-sound="sad">
                üò°
              </button>
              <button class="smiley-btn" data-smiley="üò≠" data-sound="mute">
                üò≠
              </button>
              <button class="smiley-btn" data-smiley="üëé" data-sound="suck">
                üëé</button
              ><button class="smiley-btn" data-smiley="üò§" data-sound="think">
                üò§
              </button>
              <button class="smiley-btn" data-smiley="ü¶Ü" data-sound="duck">
                ü¶Ü
              </button>
            </div>
          </div>

          <!-- ‚òÖ‚òÖ‚òÖ –£–ë–ò–†–ê–ï–ú –ß–ê–¢ –ò –û–ë–ï–†–¢–ö–£ –ö–û–ù–¢–ï–ù–¢–ê ‚òÖ‚òÖ‚òÖ -->
        </div>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π -->
      <div class="game-controls" id="gameControls">
        <!-- ‚òÖ‚òÖ‚òÖ –î–û–ë–ê–í–¨–¢–ï –≠–¢–£ –ö–ù–û–ü–ö–£ –ü–ï–†–ï–í–û–†–û–¢–ê –î–û–°–ö–ò ‚òÖ‚òÖ‚òÖ -->
        <button
          id="flipBoardButton"
          class="control-button flip-board-btn"
          title="–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –¥–æ—Å–∫—É"
        >
          üîÑ
        </button>

        <button id="newGameButton" class="control-button new-game-btn">
          –ù–æ–≤–∞—è –ò–≥—Ä–∞
        </button>
        <button id="drawOfferButton" class="control-button draw-offer-btn">
          –ù–∏—á—å—è?
        </button>
        <button id="surrenderButton" class="control-button surrender-btn">
          –°–¥–∞—Ç—å—Å—è
        </button>
      </div>

      <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã (–ò–°–ü–û–õ–¨–ó–£–ï–ú –î–õ–Ø –û–ñ–ò–î–ê–ù–ò–Ø –û–¢–í–ï–¢–ê) -->
      <div id="newGameModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2 id="newGameModalTitle">–ù–æ–≤–∞—è –ò–≥—Ä–∞</h2>
          <p id="newGameModalMessage">
            –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –ù–æ–≤—É—é –ò–≥—Ä—É?
          </p>
          <div class="modal-buttons">
            <button id="confirmNewGame" class="modal-btn confirm-btn">
              –î–∞
            </button>
            <button id="cancelNewGame" class="modal-btn cancel-btn">–ù–µ—Ç</button>
          </div>
        </div>
      </div>

      <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∏—á—å–∏ -->
      <div id="drawOfferModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∏—á—å–∏</h2>
          <p id="drawOfferText">–ò–≥—Ä–æ–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∏—á—å—é</p>

          <!-- ‚òÖ‚òÖ‚òÖ –î–û–ë–ê–í–¨–¢–ï –≠–¢–û–¢ –ë–õ–û–ö –° –†–û–ó–û–ô ‚òÖ‚òÖ‚òÖ -->
          <div
            class="rose-container"
            style="text-align: center; margin: 15px 0"
          >
            <img
              src="—Ä–æ–∑–∞.png"
              alt="–†–æ–∑–∞"
              class="rose-image"
              style="max-width: 150px; border-radius: 10px; margin: 10px 0"
            />
          </div>

          <div class="modal-buttons">
            <button id="acceptDraw" class="modal-btn confirm-btn">–î–∞</button>
            <button id="rejectDraw" class="modal-btn cancel-btn">–ù–µ—Ç</button>
          </div>
        </div>
      </div>

      <!-- ‚òÖ‚òÖ‚òÖ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ü–ï–†–í–û–ì–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –°–î–ê–ß–ò ‚òÖ‚òÖ‚òÖ -->
      <div id="surrenderFirstModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2>–°–µ—Ä—å—ë–∑–Ω–æ?</h2>
          <p>–†—É—Å—Å–∫–∏–µ –Ω–µ —Å–¥–∞—é—Ç—Å—è!</p>
          <div class="modal-buttons">
            <button id="surrenderFirstConfirm" class="modal-btn confirm-btn">
              –î–∞!
            </button>
          </div>
        </div>
      </div>

      <!-- ‚òÖ‚òÖ‚òÖ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –í–¢–û–†–û–ì–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –°–î–ê–ß–ò ‚òÖ‚òÖ‚òÖ -->
      <div id="surrenderSecondModal" class="modal" style="display: none">
        <div class="modal-content">
          <h2>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–¥–∞—Ç—å—Å—è?</h2>
          <p></p>
          <div class="modal-buttons">
            <button id="surrenderFinalConfirm" class="modal-btn confirm-btn">
              –î–∞
            </button>
            <button id="surrenderCancel" class="modal-btn cancel-btn">
              –ù–µ—Ç
            </button>
          </div>
        </div>
      </div>

      <!-- –ë–ª–æ–∫ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –∏–≥—Ä—ã (—Å–∫—Ä—ã–≤–∞–µ–º, —Ç.–∫. –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ) -->
      <div
        id="restartContainer"
        class="restart-container"
        style="display: none"
      >
        <h2
          style="
            color: #ffeb3b;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
          "
        >
          –ò–≥—Ä–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–∞!
        </h2>
        <button id="restartButton" class="restart-button">–ù–æ–≤–∞—è –ò–≥—Ä–∞</button>
        <div class="gif-container">
          <img
            src="https://media1.tenor.com/m/w_PLu8IF2Y8AAAAd/sml-joseph.gif"
            alt="Celebration"
            class="celebration-gif"
          />
        </div>
      </div>
    </div>

    <!-- ‚òÖ‚òÖ‚òÖ –ê–£–î–ò–û –≠–õ–ï–ú–ï–ù–¢–´ –î–õ–Ø –ó–í–£–ö–û–í –°–ú–ê–ô–õ–ò–ö–û–í ‚òÖ‚òÖ‚òÖ -->
    <audio id="laughSound" preload="auto">
      <source src="yoda.mp3" type="audio/mpeg" />
    </audio>
    <audio id="sadSound" preload="auto">
      <source src="sosed.mp3" type="audio/mpeg" />
    </audio>
    <audio id="coolSound" preload="auto">
      <source src="okey.mp3" type="audio/mpeg" />
    </audio>
    <audio id="suckSound" preload="auto">
      <source src="not.mp3" type="audio/mpeg" />
    </audio>
    <audio id="thinkSound" preload="auto">
      <source src="waaa 2.mp3" type="audio/mpeg" />
    </audio>
    <audio id="smirkSound" preload="auto">
      <source src="wow-mlg 2.mp3" type="audio/mpeg" />
    </audio>
    <!-- ‚òÖ‚òÖ‚òÖ –ù–û–í–´–ï –ê–£–î–ò–û –≠–õ–ï–ú–ï–ù–¢–´ ‚òÖ‚òÖ‚òÖ -->
    <audio id="clownSound" preload="auto">
      <source src="probitie1.mp3" type="audio/mpeg" />
    </audio>
    <audio id="muteSound" preload="auto">
      <source src="zvuk-aaaay-bol.mp3" type="audio/mpeg" />
    </audio>
    <audio id="pigSound" preload="auto">
      <source src="chto-proiskhodit 1.mp3" type="audio/mpeg" />
    </audio>
    <audio id="duckSound" preload="auto">
      <source src="805297__jahjahjahjah__goose-honk.mp3" type="audio/mpeg" />
    </audio>

    <!-- ‚òÖ‚òÖ‚òÖ –ê–£–î–ò–û –≠–õ–ï–ú–ï–ù–¢–´ –î–õ–Ø –§–ò–ù–ê–õ–¨–ù–´–• –ó–í–£–ö–û–í ‚òÖ‚òÖ‚òÖ -->
    <audio id="finalSound1" preload="auto">
      <source src="slavianskii-udar-mashonkoi.mp3" type="audio/mpeg" />
    </audio>
    <audio id="finalSound2" preload="auto">
      <source src="slavianskii-zazhim-iaitsami2.mp3" type="audio/mpeg" />
    </audio>
    <!-- ‚òÖ‚òÖ‚òÖ –ê–£–î–ò–û –î–õ–Ø –ù–ò–ß–¨–ï–ô ‚òÖ‚òÖ‚òÖ -->
    <audio id="drawSound" preload="auto">
      <source src="luchshe-imet-druga_xCZYGQu.mp3" type="audio/mpeg" />
    </audio>

    <!-- ‚òÖ‚òÖ‚òÖ –ê–£–î–ò–û –î–õ–Ø –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø ‚òÖ‚òÖ‚òÖ -->
    <audio id="messageSound" preload="auto">
      <source src="water.wav" type="audio/mpeg" />
    </audio>

    <script>
      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
      function showRestartConfirmation(requestedBy) {
        const modal = document.getElementById("restartModal");
        const message = document.getElementById("restartMessage");

        if (modal && message) {
          const color = requestedBy === "white" ? "–±–µ–ª—ã–µ" : "—á–µ—Ä–Ω—ã–µ";
          message.textContent = `–ò–≥—Ä–æ–∫ (${color}) –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É. –°–æ–≥–ª–∞—Å–Ω—ã?`;
          modal.style.display = "block";
        }
      }

      function hideRestartModal() {
        const modal = document.getElementById("restartModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      function confirmRestart() {
        if (window.ws && window.ws.readyState === WebSocket.OPEN) {
          window.ws.send(
            JSON.stringify({
              type: "confirmRestart",
            })
          );
        }
        hideRestartModal();
      }

      function declineRestart() {
        hideRestartModal();
      }

      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–≥—Ä–æ–∫–∞—Ö
      function updatePlayersInfo() {
        const whitePlayer = document.getElementById("whitePlayer");
        const blackPlayer = document.getElementById("blackPlayer");

        if (!whitePlayer || !blackPlayer) return;

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
        whitePlayer.classList.remove("active");
        blackPlayer.classList.remove("active");

        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
        if (window.currentPlayer === "white") {
          whitePlayer.classList.add("active");
        } else {
          blackPlayer.classList.add("active");
        }
      }

      function setPlayerNickname(color, nickname) {
        const element = document.getElementById(color + "Nickname");
        if (element) {
          element.textContent = nickname || "–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...";
        }
      }

      function showGameOverModal(message) {
        const modal = document.getElementById("gameOverModal");
        const messageElement = document.getElementById("gameOverMessage");
        if (modal && messageElement) {
          messageElement.textContent = message;
          modal.style.display = "block";
        }
      }

      function hideGameOverModal() {
        const modal = document.getElementById("gameOverModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      function startNewGame() {
        hideGameOverModal();
        showNicknameModal();
      }

      // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
      function showNicknameModal() {
        const modal = document.getElementById("nicknameModal");
        if (modal) {
          modal.style.display = "block";
          document.getElementById("nicknameInput").focus();
        }
      }

      function hideNicknameModal() {
        const modal = document.getElementById("nicknameModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      function confirmNickname() {
        const nicknameInput = document.getElementById("nicknameInput");
        const nickname = nicknameInput.value.trim();

        if (nickname) {
          if (window.playerNickname !== undefined) {
            window.playerNickname = nickname;
          }

          // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∫–Ω–µ–π–º –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
          if (window.playerColor) {
            setPlayerNickname(window.playerColor, nickname);
          }

          hideNicknameModal();

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∏–∫–∞
          if (window.resetGame) {
            window.resetGame();
          }

          // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –æ –Ω–æ–≤–æ–º –∏–≥—Ä–æ–∫–µ
          if (window.ws && window.ws.readyState === WebSocket.OPEN) {
            window.ws.send(
              JSON.stringify({
                type: "setNickname",
                nickname: nickname,
              })
            );
          }
        } else {
          alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º");
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      document.addEventListener("DOMContentLoaded", function () {
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–∏–∫–Ω–µ–π–º–∞
        const nicknameInput = document.getElementById("nicknameInput");

        if (nicknameInput) {
          nicknameInput.addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              confirmNickname();
            }
          });
        }

        // ‚òÖ‚òÖ‚òÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –ö–ù–û–ü–ö–ò –ù–û–í–û–ô –ò–ì–†–´ (–£–ü–†–û–©–ï–ù–ù–´–ï) ‚òÖ‚òÖ‚òÖ
        const newGameBtn = document.getElementById("newGameButton");
        const confirmNewGameBtn = document.getElementById("confirmNewGame");
        const cancelNewGameBtn = document.getElementById("cancelNewGame");

        if (newGameBtn) {
          newGameBtn.addEventListener("click", function () {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º CheckersGame –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            if (window.checkersGame && window.checkersGame.showNewGameModal) {
              window.checkersGame.showNewGameModal();
            }
          });
        }

        if (confirmNewGameBtn) {
          confirmNewGameBtn.addEventListener("click", function () {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º CheckersGame –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            if (
              window.checkersGame &&
              window.checkersGame.confirmNewGameAction
            ) {
              window.checkersGame.confirmNewGameAction();
            }
          });
        }

        if (cancelNewGameBtn) {
          cancelNewGameBtn.addEventListener("click", function () {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º CheckersGame –¥–ª—è –æ—Ç–º–µ–Ω—ã –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            if (window.checkersGame && window.checkersGame.hideNewGameModal) {
              window.checkersGame.hideNewGameModal();
            }
          });
        }

        // ‚òÖ‚òÖ‚òÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê –ü–ï–†–ï–ó–ê–ü–£–°–ö–ê ‚òÖ‚òÖ‚òÖ
        const confirmRestartBtn = document.getElementById("confirmRestart");
        const declineRestartBtn = document.getElementById("declineRestart");

        if (confirmRestartBtn) {
          confirmRestartBtn.addEventListener("click", function () {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º CheckersGame –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            if (window.checkersGame && window.checkersGame.acceptNewGame) {
              window.checkersGame.acceptNewGame();
            }
          });
        }

        if (declineRestartBtn) {
          declineRestartBtn.addEventListener("click", function () {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º CheckersGame –¥–ª—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            if (window.checkersGame && window.checkersGame.rejectNewGame) {
              window.checkersGame.rejectNewGame();
            }
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∏—á—å–∏
        const drawOfferBtn = document.getElementById("drawOfferButton");
        const acceptDrawBtn = document.getElementById("acceptDraw");
        const rejectDrawBtn = document.getElementById("rejectDraw");

        if (drawOfferBtn) {
          drawOfferBtn.addEventListener("click", function () {
            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "drawOffer",
                })
              );
            }
          });
        }

        if (acceptDrawBtn) {
          acceptDrawBtn.addEventListener("click", function () {
            const modal = document.getElementById("drawOfferModal");
            if (modal) modal.style.display = "none";

            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "drawResponse",
                  accept: true,
                })
              );
            }
          });
        }

        if (rejectDrawBtn) {
          rejectDrawBtn.addEventListener("click", function () {
            const modal = document.getElementById("drawOfferModal");
            if (modal) modal.style.display = "none";

            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "drawResponse",
                  accept: false,
                })
              );
            }
          });
        }

        // ‚òÖ‚òÖ‚òÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –ö–ù–û–ü–ö–ò –°–î–ê–ß–ò ‚òÖ‚òÖ‚òÖ
        const surrenderBtn = document.getElementById("surrenderButton");
        const surrenderFirstConfirm = document.getElementById(
          "surrenderFirstConfirm"
        );
        const surrenderFinalConfirm = document.getElementById(
          "surrenderFinalConfirm"
        );
        const surrenderCancel = document.getElementById("surrenderCancel");

        if (surrenderBtn) {
          surrenderBtn.addEventListener("click", function () {
            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              // –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ –∏–∑ CheckersGame
              if (window.checkersGame && window.checkersGame.offerSurrender) {
                window.checkersGame.offerSurrender();
              }
            }
          });
        }

        if (surrenderFirstConfirm) {
          surrenderFirstConfirm.addEventListener("click", function () {
            const modal = document.getElementById("surrenderFirstModal");
            if (modal) modal.style.display = "none";

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const secondModal = document.getElementById("surrenderSecondModal");
            if (secondModal) secondModal.style.display = "block";
          });
        }

        if (surrenderFinalConfirm) {
          surrenderFinalConfirm.addEventListener("click", function () {
            const modal = document.getElementById("surrenderSecondModal");
            if (modal) modal.style.display = "none";

            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "surrender",
                })
              );
            }
          });
        }

        if (surrenderCancel) {
          surrenderCancel.addEventListener("click", function () {
            const modal = document.getElementById("surrenderSecondModal");
            if (modal) modal.style.display = "none";

            if (window.checkersGame && window.checkersGame.updateStatus) {
              window.checkersGame.updateStatus("–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–æ–π! üí™");
            }
          });
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω —Å–¥–∞—á–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
        const surrenderFirstModal = document.getElementById(
          "surrenderFirstModal"
        );
        const surrenderSecondModal = document.getElementById(
          "surrenderSecondModal"
        );

        if (surrenderFirstModal) {
          surrenderFirstModal.addEventListener("click", function (e) {
            if (e.target === surrenderFirstModal) {
              surrenderFirstModal.style.display = "none";
            }
          });
        }

        if (surrenderSecondModal) {
          surrenderSecondModal.addEventListener("click", function (e) {
            if (e.target === surrenderSecondModal) {
              surrenderSecondModal.style.display = "none";
            }
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞
        const restartBtn = document.getElementById("restartButton");
        if (restartBtn) {
          restartBtn.addEventListener("click", function () {
            const restartContainer =
              document.getElementById("restartContainer");
            if (restartContainer) restartContainer.style.display = "none";

            // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
            showNicknameModal();
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
        const startGameBtn = document.getElementById("startGameButton");
        const usernameInput = document.getElementById("usernameInput");

        if (startGameBtn && usernameInput) {
          startGameBtn.addEventListener("click", function () {
            const username = usernameInput.value.trim();
            if (username) {
              // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞
              const loginModal = document.getElementById("loginModal");
              if (loginModal) loginModal.style.display = "none";

              // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∫–Ω–µ–π–º
              if (window.playerNickname !== undefined) {
                window.playerNickname = username;
              }

              // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É
              if (window.initGame) {
                window.initGame();
              }

              // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
              if (window.ws && window.ws.readyState === WebSocket.OPEN) {
                window.ws.send(
                  JSON.stringify({
                    type: "setNickname",
                    nickname: username,
                  })
                );
              }
            } else {
              alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º");
            }
          });

          usernameInput.addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              startGameBtn.click();
            }
          });
        }
      });
    </script>
    <script src="script.js"></script>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (–ò–°–ü–û–õ–¨–ó–£–ï–ú –î–õ–Ø –ó–ê–ü–†–û–°–ê –ù–û–í–û–ô –ò–ì–†–´) -->
    <div id="restartModal" class="modal" style="display: none">
      <div class="modal-content">
        <h3>–ù–æ–≤–∞—è –∏–≥—Ä–∞</h3>
        <p id="restartMessage">
          –ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É. –°–æ–≥–ª–∞—Å–Ω—ã?
        </p>
        <div class="modal-buttons">
          <button id="confirmRestart" class="modal-btn confirm-btn">–î–∞</button>
          <button id="declineRestart" class="modal-btn cancel-btn">–ù–µ—Ç</button>
        </div>
      </div>
    </div>
  </body>
</html>
