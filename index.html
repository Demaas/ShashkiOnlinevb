<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–®–∞—à–∫–∏ –û–Ω–ª–∞–π–Ω</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="loginModal" class="modal">
      <div class="modal-content">
        <h2>–í—Ö–æ–¥ –≤ –∏–≥—Ä—É</h2>
        <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã</p>
        <input
          type="text"
          id="usernameInput"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫"
          maxlength="15"
        />
        <button id="startGameButton" class="start-button">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–∏–∫–Ω–µ–π–º–∞ -->
    <div id="nicknameModal" class="modal" style="display: none">
      <div class="modal-content">
        <h2>–ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º:</p>
        <input
          type="text"
          id="nicknameInput"
          placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º"
          maxlength="15"
        />
        <div class="modal-buttons">
          <button
            onclick="confirmNickname()"
            class="modal-btn confirm-btn"
            style="background-color: #2196f3"
          >
            –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
          </button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ -->
    <div id="restartModal" class="modal" style="display: none">
      <div class="modal-content">
        <h3>–ù–æ–≤–∞—è –∏–≥—Ä–∞</h3>
        <p id="restartMessage">
          –ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É. –°–æ–≥–ª–∞—Å–Ω—ã?
        </p>
        <div class="modal-buttons">
          <button onclick="confirmRestart()" class="modal-btn confirm-btn">
            –î–∞
          </button>
          <button onclick="declineRestart()" class="modal-btn cancel-btn">
            –ù–µ—Ç
          </button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã -->
    <div id="gameOverModal" class="modal" style="display: none">
      <div class="modal-content">
        <h3>–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h3>
        <p id="gameOverMessage"></p>
        <div class="gif-container">
          <img
            src="https://media1.tenor.com/m/w_PLu8IF2Y8AAAAd/sml-joseph.gif"
            alt="Celebration"
            class="celebration-gif"
            style="max-width: 200px; border-radius: 10px; margin: 10px 0"
          />
        </div>
        <div class="modal-buttons">
          <button
            onclick="startNewGame()"
            class="modal-btn confirm-btn"
            style="background-color: #2196f3"
          >
            –ù–æ–≤–∞—è –∏–≥—Ä–∞
          </button>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>
        <img src="shasemi.png" alt="–®–∞—à–∫–∏" class="title-icon" /> –®–∞—à–∫–∏ –û–Ω–ª–∞–π–Ω
      </h1>

      <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–æ–∫–∞—Ö —Å —Ñ–æ—Ç–æ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º —Ö–æ–¥–∞ -->
      <div class="players-info">
        <div class="player-info" id="whitePlayer">
          <img src="shabe.png" alt="–ë–µ–ª—ã–µ" class="player-icon" />
          <span class="player-nickname" id="whiteNickname"
            >–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</span
          >
          <span class="turn-indicator">‚¨ÖÔ∏è –•–æ–¥</span>
        </div>
        <div class="player-info" id="blackPlayer">
          <img src="shach.png" alt="–ß–µ—Ä–Ω—ã–µ" class="player-icon" />
          <span class="player-nickname" id="blackNickname"
            >–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</span
          >
          <span class="turn-indicator">‚¨ÖÔ∏è –•–æ–¥</span>
        </div>
      </div>

      <div class="game-container">
        <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div class="board" id="board"></div>

        <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π -->
        <div class="game-controls">
          <button id="newGameButton" class="control-button new-game-btn">
            –ù–æ–≤–∞—è –ò–≥—Ä–∞
          </button>
          <button id="drawOfferButton" class="control-button draw-offer-btn">
            –ù–∏—á—å—è?
          </button>
          <button id="surrenderButton" class="control-button surrender-btn">
            –°–¥–∞—Ç—å—Å—è
          </button>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã -->
        <div id="newGameModal" class="modal" style="display: none">
          <div class="modal-content">
            <h2>–ù–æ–≤–∞—è –ò–≥—Ä–∞</h2>
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –ù–æ–≤—É—é –ò–≥—Ä—É?</p>
            <div class="modal-buttons">
              <button id="confirmNewGame" class="modal-btn confirm-btn">
                –î–∞
              </button>
              <button id="cancelNewGame" class="modal-btn cancel-btn">
                –ù–µ—Ç
              </button>
            </div>
          </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∏—á—å–∏ -->
        <div id="drawOfferModal" class="modal" style="display: none">
          <div class="modal-content">
            <h2>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∏—á—å–∏</h2>
            <p id="drawOfferText">–ò–≥—Ä–æ–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∏—á—å—é</p>
            <div class="modal-buttons">
              <button id="acceptDraw" class="modal-btn confirm-btn">–î–∞</button>
              <button id="rejectDraw" class="modal-btn cancel-btn">–ù–µ—Ç</button>
            </div>
          </div>
        </div>

        <!-- ‚òÖ‚òÖ‚òÖ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ü–ï–†–í–û–ì–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –°–î–ê–ß–ò ‚òÖ‚òÖ‚òÖ -->
        <div id="surrenderFirstModal" class="modal" style="display: none">
          <div class="modal-content">
            <h2>–°–µ—Ä—å—ë–∑–Ω–æ?</h2>
            <p>–†—É—Å—Å–∫–∏–µ –Ω–µ —Å–¥–∞—é—Ç—Å—è!</p>
            <div class="modal-buttons">
              <button id="surrenderFirstConfirm" class="modal-btn confirm-btn">
                –î–∞!
              </button>
            </div>
          </div>
        </div>

        <!-- ‚òÖ‚òÖ‚òÖ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –í–¢–û–†–û–ì–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –°–î–ê–ß–ò ‚òÖ‚òÖ‚òÖ -->
        <div id="surrenderSecondModal" class="modal" style="display: none">
          <div class="modal-content">
            <h2>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–¥–∞—Ç—å—Å—è?</h2>
            <p></p>
            <div class="modal-buttons">
              <button id="surrenderFinalConfirm" class="modal-btn confirm-btn">
                –î–∞
              </button>
              <button id="surrenderCancel" class="modal-btn cancel-btn">
                –ù–µ—Ç
              </button>
            </div>
          </div>
        </div>

        <!-- –ë–ª–æ–∫ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –∏–≥—Ä—ã (—Å–∫—Ä—ã–≤–∞–µ–º, —Ç.–∫. –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ) -->
        <div
          id="restartContainer"
          class="restart-container"
          style="display: none"
        >
          <h2
            style="
              color: #ffeb3b;
              margin-bottom: 20px;
              text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            "
          >
            –ò–≥—Ä–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–∞!
          </h2>
          <button id="restartButton" class="restart-button">–ù–æ–≤–∞—è –ò–≥—Ä–∞</button>
          <div class="gif-container">
            <img
              src="https://media1.tenor.com/m/w_PLu8IF2Y8AAAAd/sml-joseph.gif"
              alt="Celebration"
              class="celebration-gif"
            />
          </div>
        </div>
      </div>
    </div>

    <script>
      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
      function showRestartConfirmation(requestedBy) {
        const modal = document.getElementById("restartModal");
        const message = document.getElementById("restartMessage");

        if (modal && message) {
          const color = requestedBy === "white" ? "–±–µ–ª—ã–µ" : "—á–µ—Ä–Ω—ã–µ";
          message.textContent = `–ò–≥—Ä–æ–∫ (${color}) –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É. –°–æ–≥–ª–∞—Å–Ω—ã?`;
          modal.style.display = "block";
        }
      }

      function hideRestartModal() {
        const modal = document.getElementById("restartModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      function confirmRestart() {
        if (window.ws && window.ws.readyState === WebSocket.OPEN) {
          window.ws.send(
            JSON.stringify({
              type: "confirmRestart",
            })
          );
        }
        hideRestartModal();
      }

      function declineRestart() {
        hideRestartModal();
      }

      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–≥—Ä–æ–∫–∞—Ö
      function updatePlayersInfo() {
        const whitePlayer = document.getElementById("whitePlayer");
        const blackPlayer = document.getElementById("blackPlayer");

        if (!whitePlayer || !blackPlayer) return;

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
        whitePlayer.classList.remove("active");
        blackPlayer.classList.remove("active");

        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
        if (window.currentPlayer === "white") {
          whitePlayer.classList.add("active");
        } else {
          blackPlayer.classList.add("active");
        }
      }

      function setPlayerNickname(color, nickname) {
        const element = document.getElementById(color + "Nickname");
        if (element) {
          element.textContent = nickname || "–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...";
        }
      }

      function showGameOverModal(message) {
        const modal = document.getElementById("gameOverModal");
        const messageElement = document.getElementById("gameOverMessage");
        if (modal && messageElement) {
          messageElement.textContent = message;
          modal.style.display = "block";
        }
      }

      function hideGameOverModal() {
        const modal = document.getElementById("gameOverModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      function startNewGame() {
        hideGameOverModal();
        showNicknameModal();
      }

      // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
      function showNicknameModal() {
        const modal = document.getElementById("nicknameModal");
        if (modal) {
          modal.style.display = "block";
          document.getElementById("nicknameInput").focus();
        }
      }

      function hideNicknameModal() {
        const modal = document.getElementById("nicknameModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      function confirmNickname() {
        const nicknameInput = document.getElementById("nicknameInput");
        const nickname = nicknameInput.value.trim();

        if (nickname) {
          if (window.playerNickname !== undefined) {
            window.playerNickname = nickname;
          }

          // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∫–Ω–µ–π–º –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
          if (window.playerColor) {
            setPlayerNickname(window.playerColor, nickname);
          }

          hideNicknameModal();

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∏–∫–∞
          if (window.resetGame) {
            window.resetGame();
          }

          // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –æ –Ω–æ–≤–æ–º –∏–≥—Ä–æ–∫–µ
          if (window.ws && window.ws.readyState === WebSocket.OPEN) {
            window.ws.send(
              JSON.stringify({
                type: "setNickname",
                nickname: nickname,
              })
            );
          }
        } else {
          alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º");
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      document.addEventListener("DOMContentLoaded", function () {
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–∏–∫–Ω–µ–π–º–∞
        const nicknameInput = document.getElementById("nicknameInput");

        if (nicknameInput) {
          nicknameInput.addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              confirmNickname();
            }
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
        const newGameBtn = document.getElementById("newGameButton");
        const confirmNewGameBtn = document.getElementById("confirmNewGame");
        const cancelNewGameBtn = document.getElementById("cancelNewGame");

        if (newGameBtn) {
          newGameBtn.addEventListener("click", function () {
            const modal = document.getElementById("newGameModal");
            if (modal) modal.style.display = "block";
          });
        }

        if (confirmNewGameBtn) {
          confirmNewGameBtn.addEventListener("click", function () {
            const modal = document.getElementById("newGameModal");
            if (modal) modal.style.display = "none";

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ –Ω–∏–∫–Ω–µ–π–º–∞ –∏ –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
            showNicknameModal();
          });
        }

        if (cancelNewGameBtn) {
          cancelNewGameBtn.addEventListener("click", function () {
            const modal = document.getElementById("newGameModal");
            if (modal) modal.style.display = "none";
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∏—á—å–∏
        const drawOfferBtn = document.getElementById("drawOfferButton");
        const acceptDrawBtn = document.getElementById("acceptDraw");
        const rejectDrawBtn = document.getElementById("rejectDraw");

        if (drawOfferBtn) {
          drawOfferBtn.addEventListener("click", function () {
            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "drawOffer",
                })
              );
            }
          });
        }

        if (acceptDrawBtn) {
          acceptDrawBtn.addEventListener("click", function () {
            const modal = document.getElementById("drawOfferModal");
            if (modal) modal.style.display = "none";

            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "drawResponse",
                  accept: true,
                })
              );
            }
          });
        }

        if (rejectDrawBtn) {
          rejectDrawBtn.addEventListener("click", function () {
            const modal = document.getElementById("drawOfferModal");
            if (modal) modal.style.display = "none";

            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "drawResponse",
                  accept: false,
                })
              );
            }
          });
        }

        // ‚òÖ‚òÖ‚òÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –ö–ù–û–ü–ö–ò –°–î–ê–ß–ò ‚òÖ‚òÖ‚òÖ
        const surrenderBtn = document.getElementById("surrenderButton");
        const surrenderFirstConfirm = document.getElementById(
          "surrenderFirstConfirm"
        );
        const surrenderFinalConfirm = document.getElementById(
          "surrenderFinalConfirm"
        );
        const surrenderCancel = document.getElementById("surrenderCancel");

        if (surrenderBtn) {
          surrenderBtn.addEventListener("click", function () {
            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              // –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ –∏–∑ CheckersGame
              if (window.checkersGame && window.checkersGame.offerSurrender) {
                window.checkersGame.offerSurrender();
              }
            }
          });
        }

        if (surrenderFirstConfirm) {
          surrenderFirstConfirm.addEventListener("click", function () {
            const modal = document.getElementById("surrenderFirstModal");
            if (modal) modal.style.display = "none";

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const secondModal = document.getElementById("surrenderSecondModal");
            if (secondModal) secondModal.style.display = "block";
          });
        }

        if (surrenderFinalConfirm) {
          surrenderFinalConfirm.addEventListener("click", function () {
            const modal = document.getElementById("surrenderSecondModal");
            if (modal) modal.style.display = "none";

            if (window.ws && window.ws.readyState === WebSocket.OPEN) {
              window.ws.send(
                JSON.stringify({
                  type: "surrender",
                })
              );
            }
          });
        }

        if (surrenderCancel) {
          surrenderCancel.addEventListener("click", function () {
            const modal = document.getElementById("surrenderSecondModal");
            if (modal) modal.style.display = "none";

            if (window.checkersGame && window.checkersGame.updateStatus) {
              window.checkersGame.updateStatus("–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–æ–π! üí™");
            }
          });
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω —Å–¥–∞—á–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
        const surrenderFirstModal = document.getElementById(
          "surrenderFirstModal"
        );
        const surrenderSecondModal = document.getElementById(
          "surrenderSecondModal"
        );

        if (surrenderFirstModal) {
          surrenderFirstModal.addEventListener("click", function (e) {
            if (e.target === surrenderFirstModal) {
              surrenderFirstModal.style.display = "none";
            }
          });
        }

        if (surrenderSecondModal) {
          surrenderSecondModal.addEventListener("click", function (e) {
            if (e.target === surrenderSecondModal) {
              surrenderSecondModal.style.display = "none";
            }
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞
        const restartBtn = document.getElementById("restartButton");
        if (restartBtn) {
          restartBtn.addEventListener("click", function () {
            const restartContainer =
              document.getElementById("restartContainer");
            if (restartContainer) restartContainer.style.display = "none";

            // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
            showNicknameModal();
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
        const startGameBtn = document.getElementById("startGameButton");
        const usernameInput = document.getElementById("usernameInput");

        if (startGameBtn && usernameInput) {
          startGameBtn.addEventListener("click", function () {
            const username = usernameInput.value.trim();
            if (username) {
              // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞
              const loginModal = document.getElementById("loginModal");
              if (loginModal) loginModal.style.display = "none";

              // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∫–Ω–µ–π–º
              if (window.playerNickname !== undefined) {
                window.playerNickname = username;
              }

              // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É
              if (window.initGame) {
                window.initGame();
              }

              // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∏–∫–Ω–µ–π–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
              if (window.ws && window.ws.readyState === WebSocket.OPEN) {
                window.ws.send(
                  JSON.stringify({
                    type: "setNickname",
                    nickname: username,
                  })
                );
              }
            } else {
              alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º");
            }
          });

          usernameInput.addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              startGameBtn.click();
            }
          });
        }
      });
    </script>
    <script src="script.js"></script>
  </body>
</html>
